import Aside from '~/components/configurable/Aside'

<Title>Async SSR</Title>

## What is Async SSR?

Async SSR is a server side rendering technique used by most javascript meta-frameworks like Next.js, Nuxt.js, Gatsby, etc. It is a technique that allows you to completely render your application on the server and send the HTML to the client along with the appropriate asynchronous data already fetched. This allows the client to render the page without having to wait for the data to be fetched.

Solid.js offers a similar technique through the use of the `renderToStringAsync` function. This function allows you to render your application on the server and send the HTML to the client along with all the asynchronous data already fetched. This allows your application to be completely client agnostic and not have to worry about client side data fetching.

## How does `renderToStringAsync` work?

`renderToStringAsync` works by taking a component and returning a promise that resolves to a string of HTML. This string of HTML is the rendered component with all the asynchronous data already fetched and serialized. Therefore, the whole application is ready to be hydrated by the time it reaches the client.

```jsx
import { renderToStringAsync } from 'solid-js/web'

const App = () => {
  const [data, setData] = createSignal(null)

  onMount(async () => {
    const response = await fetch('https://jsonplaceholder.typicode.com/todos/1')
    const json = await response.json()
    setData(json)
  })

  return (
    <div>
      <h1>Async SSR</h1>
      <p>{data() && data().title}</p>
    </div>
  )
}

renderToStringAsync(App).then(html => {
  console.log(html)
})
```

The above code will render the `App` component on the server and return a promise that resolves to HTML once the asynchronous data has been fetched. The HTML will look something like this:

```html
<div>
  <h1>Async SSR</h1>
  <p>delectus aut autem</p>
</div>
```

## How to use `renderToStringAsync`?

In order to use `renderToStringAsync` you'll need a server which can run javascript. You can use any server you want, but for the sake of this example we'll use [Express](https://expressjs.com/).

```js
// server.js
import express from 'express'
import { renderToStringAsync } from 'solid-js/web'
import App from './App'

const app = express()

app.get('/', async (req, res) => {
  const html = await renderToStringAsync(() => <App/>)
  res.send(html)
})

app.listen(3000, () => {
  console.log('Server running on port 3000')
})
```

```jsx
// App.js
import {createResource} from 'solid-js'

export default function App() {
  const [data, setData] = createResource(() => fetch('https://jsonplaceholder.typicode.com/todos/1').then(res => res.json()))

  return (
    <div>
      <h1>Async SSR</h1>
      <p>{data().title}</p>
    </div>
  )
}
```

<Aside>
  Keep in mind that you will need a bundler like Vite, Webpack, or Rollup to bundle your application. Here's a fully functional example using rollup and express. <a href="https://github.com/ryansolid/solid-ssr-workbench">solid-ssr-workbench</a>
</Aside>